<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ø¤Ø³Ø³Ø© Ù‚Ø·Ø±Ø§Øª Ø§Ù„Ø®ÙŠØ±ÙŠØ© - Ù…Ø¨Ø§Ø¯Ø±Ø© ØµØ¯Ù‚Ø§Øª</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary-color: #2B7A78;
            --primary-dark: #1F5F5C;
            --secondary-color: #3AAFA9;
            --accent-color: #DEF2F1;
            --success-color: #17C3B2;
            --warning-color: #FFC857;
            --danger-color: #E63946;
            --text-primary: #2C3E50;
            --text-secondary: #5D6D7E;
            --bg-primary: #F8F9FA;
            --bg-secondary: #FFFFFF;
            --shadow-sm: 0 2px 8px rgba(43, 122, 120, 0.08);
            --shadow-md: 0 4px 16px rgba(43, 122, 120, 0.12);
            --shadow-lg: 0 8px 32px rgba(43, 122, 120, 0.16);
            --border-radius: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="dark"] {
            --primary-color: #3AAFA9;
            --primary-dark: #2B7A78;
            --accent-color: #1F3A38;
            --text-primary: #E8F1F0;
            --text-secondary: #B8C9C8;
            --bg-primary: #0F1419;
            --bg-secondary: #1A2128;
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', 'Cairo', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            transition: var(--transition);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: var(--shadow-md);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .header-text {
            text-align: right;
        }

        .header h1 {
            color: white;
            font-size: 28px;
            font-weight: 900;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            font-family: 'Cairo', sans-serif;
        }

        .header p {
            color: var(--accent-color);
            font-size: 14px;
            font-weight: 500;
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .icon-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .icon-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .icon-btn:active {
            transform: scale(0.95);
        }

        .currency-selector {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 600;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: var(--transition);
        }

        .currency-selector:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .currency-selector option {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            animation: fadeInUp 0.6s ease-out 0.2s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        #caseFormSection,
        #bankFormSection {
            animation: slideIn 0.4s ease-out;
        }

        .stat-card {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 900;
            color: var(--primary-color);
            font-family: 'Cairo', sans-serif;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .cases-grid {
            display: block;
            margin-bottom: 80px;
        }

        .case-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            transition: var(--transition);
            animation: fadeInUp 0.6s ease-out both;
            border: 1px solid #e8e8e8;
        }

        .case-card:nth-child(1) { animation-delay: 0.1s; }
        .case-card:nth-child(2) { animation-delay: 0.2s; }
        .case-card:nth-child(3) { animation-delay: 0.3s; }
        .case-card:nth-child(4) { animation-delay: 0.4s; }

        .case-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            border-color: var(--primary-color);
        }

        .case-images {
            position: relative;
            height: 280px;
            overflow: hidden;
            background: #f0f0f0;
        }

        .case-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            cursor: pointer;
            transition: transform 0.5s ease;
            display: none;
        }

        .case-image.active {
            display: block;
        }

        .case-image:hover {
            transform: scale(1.05);
        }

        .image-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-nav:hover {
            background: rgba(0, 0, 0, 0.7);
            transform: translateY(-50%) scale(1.1);
        }

        .image-nav.prev { left: 10px; }
        .image-nav.next { right: 10px; }

        .image-indicators {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 6px;
        }

        .indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: var(--transition);
        }

        .indicator.active {
            background: white;
            width: 24px;
            border-radius: 4px;
        }

        .slideshow-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            backdrop-filter: blur(5px);
            transition: var(--transition);
            font-family: 'Tajawal', sans-serif;
        }

        .slideshow-btn:hover {
            background: rgba(0, 0, 0, 0.7);
        }

        .slideshow-btn.playing {
            background: var(--primary-color);
        }

        .case-content {
            padding: 20px;
        }

        .case-status {
            display: inline-block;
            font-size: 12px;
            font-weight: 600;
            color: #666;
        }

        .case-status.active {
            color: #3B82F6;
        }

        .case-status.completed {
            color: #10B981;
        }

        .case-status.urgent {
            color: #EF4444;
        }

        .case-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--text-primary);
            font-family: 'Cairo', sans-serif;
        }

        .case-description {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.8;
            max-height: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .progress-section {
            margin-bottom: 20px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .collected {
            color: var(--success-color);
            font-weight: 700;
            font-family: 'Cairo', sans-serif;
        }

        .remaining {
            color: var(--danger-color);
            font-weight: 700;
            font-family: 'Cairo', sans-serif;
        }

        .progress-bar-container {
            height: 8px;
            background: #f0f0f0;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color));
            border-radius: 8px;
            transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: 700;
            font-size: 11px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .case-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid #e0e0e0;
        }

        .btn-secondary:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-lg);
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-close {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--danger-color);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            transform: rotate(90deg) scale(1.1);
            background: #C62828;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--primary-color);
            font-family: 'Cairo', sans-serif;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--accent-color);
            border-radius: 12px;
            font-family: 'Tajawal', sans-serif;
            font-size: 14px;
            transition: var(--transition);
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(43, 122, 120, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .file-upload {
            border: 2px dashed var(--accent-color);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: var(--bg-primary);
        }

        .file-upload:hover {
            border-color: var(--primary-color);
            background: var(--accent-color);
        }

        .file-upload.drag-over {
            border-color: var(--success-color);
            background: rgba(23, 195, 178, 0.1);
        }

        .file-input {
            display: none;
        }

        .preview-images {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .preview-image {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
        }

        .preview-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-remove {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--danger-color);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .image-viewer.active {
            display: flex;
        }

        .viewer-content {
            position: relative;
            max-width: 95%;
            max-height: 95%;
        }

        .viewer-image {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
            border-radius: 8px;
        }

        .viewer-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 30px;
            backdrop-filter: blur(10px);
        }

        .viewer-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .viewer-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .viewer-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--danger-color);
            color: white;
            border: none;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            transition: var(--transition);
            z-index: 10;
        }

        .viewer-close:hover {
            transform: rotate(90deg) scale(1.1);
        }

        .admin-trigger {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            z-index: 500;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .admin-trigger:hover {
            transform: scale(1.1) rotate(90deg);
        }

        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1500;
            overflow-y: auto;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-content {
            background: var(--bg-secondary);
            max-width: 900px;
            margin: 30px auto;
            border-radius: var(--border-radius);
            padding: 30px;
            animation: slideUp 0.4s ease-out;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--accent-color);
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .admin-tab {
            padding: 12px 24px;
            background: var(--accent-color);
            border: none;
            border-radius: 12px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-primary);
        }

        .admin-tab.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .admin-tab:hover {
            transform: translateY(-2px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeInUp 0.4s ease-out;
        }

        .cases-list {
            display: grid;
            gap: 15px;
        }

        .case-item {
            background: var(--bg-primary);
            padding: 20px;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .case-item:hover {
            border-color: var(--primary-color);
            transform: translateX(-5px);
        }

        .case-item-info {
            flex: 1;
        }

        .case-item-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 12px;
            border-radius: 8px;
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #C62828;
        }

        .btn-edit {
            background: var(--warning-color);
            color: #2C3E50;
        }

        .btn-edit:hover {
            background: #FFA726;
        }

        .bank-accounts {
            display: grid;
            gap: 15px;
        }

        .bank-account {
            background: var(--bg-primary);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--accent-color);
        }

        .bank-info {
            display: grid;
            gap: 10px;
        }

        .bank-info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--accent-color);
        }

        .bank-info-label {
            font-weight: 600;
            color: var(--text-secondary);
        }

        .bank-info-value {
            font-weight: 700;
            color: var(--primary-color);
            font-family: 'Cairo', sans-serif;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .notification {
            position: fixed;
            top: 100px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            z-index: 3000;
            transform: translateX(400px);
            transition: var(--transition);
            font-weight: 600;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: var(--danger-color);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 22px;
            }

            .header-content {
                justify-content: center;
            }

            .controls {
                width: 100%;
                justify-content: center;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .cases-grid {
                grid-template-columns: 1fr;
            }
            
            .case-images {
                height: 220px;
            }

            .modal-content {
                width: 95%;
                padding: 20px;
            }

            .admin-content {
                margin: 15px;
                padding: 20px;
            }

            .case-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .case-item-actions {
                width: 100%;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo-section">
                <svg class="logo" width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="24" cy="24" r="22" fill="white" fill-opacity="0.15"/>
                    <path d="M24 8C24 8 18 14 18 24C18 29.5228 22.4772 34 28 34C33.5228 34 38 29.5228 38 24C38 14 32 8 32 8C32 8 29 12 24 12C19 12 16 8 16 8" fill="white"/>
                    <path d="M24 34C24 34 20 37 20 42C20 44.2091 21.7909 46 24 46C26.2091 46 28 44.2091 28 42C28 37 24 34 24 34" fill="white" fill-opacity="0.85"/>
                </svg>
                <div class="header-text">
                    <h1>Ù…Ø¤Ø³Ø³Ø© Ù‚Ø·Ø±Ø§Øª Ø§Ù„Ø®ÙŠØ±ÙŠØ©</h1>
                    <p>ÙƒÙ„ Ù‚Ø·Ø±Ø© ØªØµÙ†Ø¹ ÙØ±Ù‚Ø§Ù‹</p>
                </div>
            </div>
            <div class="controls">
                <button class="icon-btn" id="themeToggle" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Statistics -->
        <div class="stats-grid" id="statsGrid"></div>

        <!-- Cases Grid -->
        <div class="cases-grid" id="casesGrid"></div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState" style="display: none;">
            <div class="empty-state-icon">ğŸ“‹</div>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø§Ù„Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</h3>
            <p>Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø­ØªØ§Ø¬Ø© Ù‡Ù†Ø§</p>
        </div>
    </div>

    <!-- Donation Modal -->
    <div class="modal" id="donationModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeDonationModal()">Ã—</button>
            <h2 class="modal-title">ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ¨Ø±Ø¹</h2>
            <div id="donationContent"></div>
        </div>
    </div>

    <!-- Image Viewer -->
    <div class="image-viewer" id="imageViewer">
        <button class="viewer-close" onclick="closeImageViewer()">Ã—</button>
        <div class="viewer-content">
            <img class="viewer-image" id="viewerImage" src="" alt="">
            <div class="viewer-controls">
                <button class="viewer-btn" onclick="navigateViewerImage(-1)" title="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©">â—€</button>
                <button class="viewer-btn" onclick="downloadViewerImage()" title="ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©">â¬‡</button>
                <button class="viewer-btn" onclick="shareViewerImage()" title="Ù…Ø´Ø§Ø±ÙƒØ©">ğŸ“¤</button>
                <button class="viewer-btn" onclick="navigateViewerImage(1)" title="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©">â–¶</button>
            </div>
        </div>
    </div>

    <!-- Admin Trigger - Hidden, activated by secret gesture -->
    <div class="admin-trigger" id="adminTrigger" style="display: none;">âš™ï¸</div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-content">
            <div class="admin-header">
                <h2 style="color: var(--primary-color); font-family: 'Cairo', sans-serif;">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
                <button class="btn btn-danger btn-small" onclick="closeAdminPanel()">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>

            <div class="admin-tabs">
                <button class="admin-tab active" onclick="switchAdminTab('initiatives')">Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª</button>
                <button class="admin-tab" onclick="switchAdminTab('bank')">Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©</button>
                <button class="admin-tab" onclick="switchAdminTab('settings')">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
            </div>

            <div id="initiativesTab" class="tab-content active">
                <!-- Initiative Form Section -->
                <div id="initiativeFormSection" style="display: none; margin-bottom: 30px; padding: 25px; background: var(--bg-primary); border-radius: var(--border-radius); border: 2px solid var(--primary-color);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 id="initiativeFormTitle" style="color: var(--primary-color); font-family: 'Cairo', sans-serif;">Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ø§Ø¯Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                        <button class="btn btn-danger btn-small" onclick="cancelInitiativeForm()">Ø¥Ù„ØºØ§Ø¡</button>
                    </div>
                    <form id="initiativeForm" onsubmit="submitInitiativeForm(event)">
                        <div class="form-group">
                            <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø© *</label>
                            <input type="text" class="form-input" id="initiativeName" required placeholder="Ù…Ø«Ø§Ù„: Ù…Ø¨Ø§Ø¯Ø±Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ÙˆØµÙ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø© *</label>
                            <textarea class="form-textarea" id="initiativeDescription" required placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ù…Ø¨Ø§Ø¯Ø±Ø© ÙˆØ£Ù‡Ø¯Ø§ÙÙ‡Ø§"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©</label>
                            <select class="form-input" id="initiativeIcon">
                                <option value="ğŸ¥">ğŸ¥ Ø¹Ù„Ø§Ø¬</option>
                                <option value="ğŸ">ğŸ Ø·Ø¹Ø§Ù…</option>
                                <option value="ğŸ ">ğŸ  Ù…Ø³ÙƒÙ†</option>
                                <option value="ğŸ“š">ğŸ“š ØªØ¹Ù„ÙŠÙ…</option>
                                <option value="ğŸ‘¶">ğŸ‘¶ Ø£Ø·ÙØ§Ù„</option>
                                <option value="ğŸ‘´">ğŸ‘´ ÙƒØ¨Ø§Ø± Ø§Ù„Ø³Ù†</option>
                                <option value="ğŸ’">ğŸ’ Ø²ÙˆØ§Ø¬</option>
                                <option value="ğŸŒŠ">ğŸŒŠ ÙƒÙˆØ§Ø±Ø«</option>
                                <option value="ğŸ•Œ">ğŸ•Œ Ù…Ø³Ø§Ø¬Ø¯</option>
                                <option value="ğŸ’š">ğŸ’š Ø¹Ø§Ù…</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ù„ÙˆÙ† Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©</label>
                            <select class="form-input" id="initiativeColor">
                                <option value="#2B7A78">Ø£Ø®Ø¶Ø± Ù…Ø²Ø±Ù‚ (Ø§ÙØªØ±Ø§Ø¶ÙŠ)</option>
                                <option value="#E63946">Ø£Ø­Ù…Ø±</option>
                                <option value="#457B9D">Ø£Ø²Ø±Ù‚</option>
                                <option value="#2A9D8F">Ø£Ø®Ø¶Ø± ÙØ§ØªØ­</option>
                                <option value="#E76F51">Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ</option>
                                <option value="#8E44AD">Ø¨Ù†ÙØ³Ø¬ÙŠ</option>
                                <option value="#E67E22">Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ ØºØ§Ù…Ù‚</option>
                                <option value="#16A085">ØªØ±ÙƒÙˆØ§Ø²</option>
                            </select>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button type="submit" class="btn btn-primary" style="flex: 1;">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©</button>
                            <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="cancelInitiativeForm()">Ø¥Ù„ØºØ§Ø¡</button>
                        </div>
                    </form>
                </div>

                <!-- Case Form Section (inside initiative) -->
                <div id="caseFormSection" style="display: none; margin-bottom: 30px; padding: 25px; background: var(--bg-primary); border-radius: var(--border-radius); border: 2px solid var(--primary-color);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 id="caseFormTitle" style="color: var(--primary-color); font-family: 'Cairo', sans-serif;">Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                        <button class="btn btn-danger btn-small" onclick="cancelCaseForm()">Ø¥Ù„ØºØ§Ø¡</button>
                    </div>
                    <form id="caseForm" onsubmit="submitCaseForm(event)">
                        <div class="form-group">
                            <label class="form-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ø§Ù„Ø© *</label>
                            <input type="text" class="form-input" id="caseTitle" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ÙˆØµÙ Ø§Ù„Ø­Ø§Ù„Ø© *</label>
                            <textarea class="form-textarea" id="caseDescription" required></textarea>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div class="form-group">
                                <label class="form-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ *</label>
                                <input type="number" class="form-input" id="caseTarget" required min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø­Ø§Ù„ÙŠØ§Ù‹</label>
                                <input type="number" class="form-input" id="caseCollected" value="0" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø©</label>
                                <select class="form-input" id="caseStatus">
                                    <option value="active">Ù†Ø´Ø·Ø©</option>
                                    <option value="urgent">Ø¹Ø§Ø¬Ù„Ø©</option>
                                    <option value="completed">Ù…ÙƒØªÙ…Ù„Ø©</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ØµÙˆØ± Ø§Ù„Ø­Ø§Ù„Ø© *</label>
                            <div class="file-upload" id="fileUploadZone">
                                <input type="file" class="file-input" id="caseImages" multiple accept="image/*">
                                <p>ğŸ“· Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø§Ù„ØµÙˆØ± Ù‡Ù†Ø§</p>
                                <small style="color: var(--text-secondary);">ÙŠÙ…ÙƒÙ†Ùƒ Ø±ÙØ¹ Ø¹Ø¯Ø© ØµÙˆØ±</small>
                            </div>
                            <div class="preview-images" id="previewImages"></div>
                        </div>
                        <input type="hidden" id="caseInitiativeId">
                        <div style="display: flex; gap: 10px;">
                            <button type="submit" class="btn btn-primary" style="flex: 1;">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø©</button>
                            <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="cancelCaseForm()">Ø¥Ù„ØºØ§Ø¡</button>
                        </div>
                    </form>
                </div>
                
                <!-- Initiatives List with their cases -->
                <div id="initiativesListSection">
                    <button class="btn btn-primary" onclick="showAddInitiativeForm()" style="margin-bottom: 20px;">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ø§Ø¯Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
                    <div id="initiativesList"></div>
                </div>
            </div>

            <div id="bankTab" class="tab-content">
                <div id="bankFormSection" style="display: none; margin-bottom: 30px; padding: 25px; background: var(--bg-primary); border-radius: var(--border-radius); border: 2px solid var(--primary-color);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: var(--primary-color); font-family: 'Cairo', sans-serif;">Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨ Ø¨Ù†ÙƒÙŠ</h3>
                        <button class="btn btn-danger btn-small" onclick="cancelBankForm()">Ø¥Ù„ØºØ§Ø¡</button>
                    </div>
                    <form id="bankForm" onsubmit="submitBankForm(event)">
                        <div class="form-group">
                            <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ *</label>
                            <input type="text" class="form-input" id="bankName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ *</label>
                            <input type="text" class="form-input" id="bankAccount" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ø­Ø³Ø§Ø¨ *</label>
                            <input type="text" class="form-input" id="bankOwner" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">IBAN (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                            <input type="text" class="form-input" id="bankIban">
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button type="submit" class="btn btn-primary" style="flex: 1;">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
                            <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="cancelBankForm()">Ø¥Ù„ØºØ§Ø¡</button>
                        </div>
                    </form>
                </div>
                
                <div id="bankListSection">
                    <button class="btn btn-primary" onclick="showAddBankForm()" style="margin-bottom: 20px;">â• Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨ Ø¨Ù†ÙƒÙŠ</button>
                    <div class="bank-accounts" id="bankAccountsList"></div>
                </div>
            </div>

            <div id="settingsTab" class="tab-content">
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©</label>
                    <select class="form-input" id="currencySelector">
                        <option value="SDG">Ø¬Ù†ÙŠÙ‡ Ø³ÙˆØ¯Ø§Ù†ÙŠ (Ø¬.Ø³)</option>
                        <option value="USD">Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ ($)</option>
                        <option value="SAR">Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ (Ø±.Ø³)</option>
                        <option value="AED">Ø¯Ø±Ù‡Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ (Ø¯.Ø¥)</option>
                        <option value="EGP">Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ (Ø¬.Ù…)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù†</label>
                    <input type="password" class="form-input" id="adminPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©">
                </div>
                
                <hr style="margin: 25px 0; border: 1px solid #e0e0e0;">
                
                <h4 style="color: var(--primary-color); margin-bottom: 15px; font-family: 'Cairo', sans-serif;">ğŸ“± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…</h4>
                
                <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 12px; padding: 15px; margin-bottom: 20px;">
                    <strong style="color: #856404; display: block; margin-bottom: 10px;">âš ï¸ Ø®Ø·ÙˆØ§Øª Ù…Ù‡Ù…Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡:</strong>
                    <ol style="color: #856404; font-size: 13px; line-height: 1.8; margin: 0; padding-right: 20px;">
                        <li>Ø£Ù†Ø´Ø¦ Ø§Ù„Ø¨ÙˆØª Ù…Ù† <a href="https://t.me/BotFather" target="_blank" style="color: #0066cc;">@BotFather</a> ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†</li>
                        <li>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Chat ID Ù…Ù† <a href="https://t.me/userinfobot" target="_blank" style="color: #0066cc;">@userinfobot</a></li>
                        <li><strong>Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹:</strong> Ø§ÙØªØ­ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ÙÙŠ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… ÙˆØ§Ø¶ØºØ· "Start" Ø£Ùˆ Ø£Ø±Ø³Ù„ Ø£ÙŠ Ø±Ø³Ø§Ù„Ø©</li>
                        <li>Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø¯Ù†Ø§Ù‡ ÙˆØ§Ø¶ØºØ· "Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"</li>
                        <li>Ø§Ø®ØªØ¨Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„"</li>
                    </ol>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Telegram Bot Token</label>
                    <input type="text" class="form-input" id="telegramBotToken" placeholder="Ù…Ø«Ø§Ù„: 123456789:ABCdefGHIjklMNOpqrsTUVwxyz">
                    <small style="color: var(--text-secondary); font-size: 12px;">
                        Ø§Ø­ØµÙ„ Ø¹Ù„ÙŠÙ‡ Ù…Ù† <a href="https://t.me/BotFather" target="_blank" style="color: var(--primary-color);">@BotFather</a>
                    </small>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Telegram Chat ID</label>
                    <input type="text" class="form-input" id="telegramChatId" placeholder="Ù…Ø«Ø§Ù„: 123456789">
                    <small style="color: var(--text-secondary); font-size: 12px;">
                        Ù…Ø¹Ø±Ù‘Ù Ø­Ø³Ø§Ø¨ÙƒØŒ Ø§Ø­ØµÙ„ Ø¹Ù„ÙŠÙ‡ Ù…Ù† <a href="https://t.me/userinfobot" target="_blank" style="color: var(--primary-color);">@userinfobot</a>
                    </small>
                </div>
                
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <button class="btn btn-primary" onclick="updateSettings()" style="flex: 1;">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                    <button class="btn btn-secondary" onclick="testTelegramConnection()" style="flex: 1;">ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</button>
                </div>
                
                <hr style="margin: 25px 0; border: 1px solid var(--accent-color);">
                
                <div style="background: var(--accent-color); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h4 style="color: var(--primary-color); margin-bottom: 10px;">ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ®Ø²ÙŠÙ†</h4>
                    <p id="storageInfo" style="font-size: 14px; color: var(--text-secondary); margin-bottom: 10px;">
                        Ø¬Ø§Ø±ÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©...
                    </p>
                    <button class="btn btn-secondary btn-small" onclick="updateStorageInfo()">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
                </div>
                
                <div style="background: rgba(230, 57, 70, 0.1); padding: 20px; border-radius: 12px; border: 2px solid var(--danger-color);">
                    <h4 style="color: var(--danger-color); margin-bottom: 10px;">âš ï¸ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø®Ø·Ø±</h4>
                    <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 15px;">
                        Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø³ÙŠØ¤Ø¯ÙŠ Ù„Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª ÙˆØ§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ© ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ø´ÙƒÙ„ Ù†Ù‡Ø§Ø¦ÙŠ.
                    </p>
                    <button class="btn btn-danger" onclick="clearAllData()" style="width: 100%;">ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Case Modal -->
    <div class="modal" id="caseModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeCaseModal()">Ã—</button>
            <h2 class="modal-title" id="caseModalTitle">Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
            <form id="caseForm">
                <div class="form-group">
                    <label class="form-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ø§Ù„Ø© *</label>
                    <input type="text" class="form-input" id="caseTitle" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ÙˆØµÙ Ø§Ù„Ø­Ø§Ù„Ø© *</label>
                    <textarea class="form-textarea" id="caseDescription" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ *</label>
                    <input type="number" class="form-input" id="caseTarget" required min="0">
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø­Ø§Ù„ÙŠØ§Ù‹</label>
                    <input type="number" class="form-input" id="caseCollected" value="0" min="0">
                </div>
                <div class="form-group">
                    <label class="form-label">Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø©</label>
                    <select class="form-input" id="caseStatus">
                        <option value="active">Ù†Ø´Ø·Ø©</option>
                        <option value="urgent">Ø¹Ø§Ø¬Ù„Ø©</option>
                        <option value="completed">Ù…ÙƒØªÙ…Ù„Ø©</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">ØµÙˆØ± Ø§Ù„Ø­Ø§Ù„Ø© *</label>
                    <div class="file-upload" id="fileUploadZone">
                        <input type="file" class="file-input" id="caseImages" multiple accept="image/*">
                        <p>ğŸ“· Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø§Ù„ØµÙˆØ± Ù‡Ù†Ø§</p>
                        <small style="color: var(--text-secondary);">ÙŠÙ…ÙƒÙ†Ùƒ Ø±ÙØ¹ Ø¹Ø¯Ø© ØµÙˆØ±</small>
                    </div>
                    <div class="preview-images" id="previewImages"></div>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø©</button>
            </form>
        </div>
    </div>

    <!-- Bank Account Modal -->
    <div class="modal" id="bankModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeBankModal()">Ã—</button>
            <h2 class="modal-title">Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨ Ø¨Ù†ÙƒÙŠ</h2>
            <form id="bankForm">
                <div class="form-group">
                    <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ *</label>
                    <input type="text" class="form-input" id="bankName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ *</label>
                    <input type="text" class="form-input" id="bankAccount" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ø­Ø³Ø§Ø¨ *</label>
                    <input type="text" class="form-input" id="bankOwner" required>
                </div>
                <div class="form-group">
                    <label class="form-label">IBAN (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <input type="text" class="form-input" id="bankIban">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
            </form>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // Initialize Telegram Web App
        let tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
        }

        // Data Storage
        let appData = {
            initiatives: [], // New: categories/initiatives
            cases: [],
            bankAccounts: [],
            adminPassword: 'admin123', // Default password
            currency: 'SDG',
            theme: 'light',
            telegramBotToken: '',
            telegramChatId: ''
        };

        // Load data from localStorage
        function loadData() {
            const stored = localStorage.getItem('qataratData');
            if (stored) {
                appData = { ...appData, ...JSON.parse(stored) };
            }
            applyCurrency();
            applyTheme();
        }

        // Save data to localStorage
        function saveData() {
            try {
                const dataStr = JSON.stringify(appData);
                localStorage.setItem('qataratData', dataStr);
                console.log('Data saved successfully, size:', dataStr.length);
                return true;
            } catch (error) {
                console.error('Error saving data:', error);
                if (error.name === 'QuotaExceededError') {
                    showNotification('Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ†ÙŠØ© Ù…Ù…ØªÙ„Ø¦Ø©. ÙŠØ±Ø¬Ù‰ Ø­Ø°Ù Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©', true);
                } else {
                    showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message, true);
                }
                return false;
            }
        }

        // Currency symbols
        const currencySymbols = {
            'SDG': 'Ø¬.Ø³',
            'USD': '$',
            'SAR': 'Ø±.Ø³',
            'AED': 'Ø¯.Ø¥',
            'EGP': 'Ø¬.Ù…'
        };

        // Format number with currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('ar-SD').format(amount) + ' ' + currencySymbols[appData.currency];
        }

        // Theme toggle
        function applyTheme() {
            const themeToggle = document.getElementById('themeToggle');
            if (appData.theme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                if (themeToggle) themeToggle.textContent = 'â˜€ï¸';
            } else {
                document.documentElement.removeAttribute('data-theme');
                if (themeToggle) themeToggle.textContent = 'ğŸŒ™';
            }
        }

        function toggleTheme() {
            appData.theme = appData.theme === 'light' ? 'dark' : 'light';
            saveData();
            applyTheme();
        }

        function applyCurrency() {
            const currencySelector = document.getElementById('currencySelector');
            if (currencySelector) {
                currencySelector.value = appData.currency;
            }
        }

        // Render statistics
        function renderStats() {
            const totalCases = appData.cases.length;
            const activeCases = appData.cases.filter(c => c.status === 'active' || c.status === 'urgent').length;
            const totalTarget = appData.cases.reduce((sum, c) => sum + c.target, 0);
            const totalCollected = appData.cases.reduce((sum, c) => sum + c.collected, 0);

            const statsHTML = `
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-value">${totalCases}</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø§Ù„Ø§Øª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">âœ…</div>
                    <div class="stat-value">${activeCases}</div>
                    <div class="stat-label">Ø­Ø§Ù„Ø§Øª Ù†Ø´Ø·Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’°</div>
                    <div class="stat-value">${formatCurrency(totalCollected)}</div>
                    <div class="stat-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ¯</div>
                    <div class="stat-value">${formatCurrency(totalTarget)}</div>
                    <div class="stat-label">Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
                </div>
            `;
            document.getElementById('statsGrid').innerHTML = statsHTML;
        }

        // Render cases
        function renderCases() {
            const casesGrid = document.getElementById('casesGrid');
            const emptyState = document.getElementById('emptyState');

            if (appData.cases.length === 0) {
                casesGrid.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';
            
            // Group cases by initiative
            const casesByInitiative = {};
            appData.cases.forEach((caseItem, index) => {
                const initId = caseItem.initiativeId !== undefined ? caseItem.initiativeId : 'unassigned';
                if (!casesByInitiative[initId]) {
                    casesByInitiative[initId] = [];
                }
                casesByInitiative[initId].push({ ...caseItem, originalIndex: index });
            });

            let html = '';

            // Render initiatives with their cases
            Object.keys(casesByInitiative).sort().forEach(initId => {
                const initiative = initId === 'unassigned' ? null : appData.initiatives[initId];
                const cases = casesByInitiative[initId];

                // Initiative Container Start
                if (initiative) {
                    html += `
                        <div style="grid-column: 1 / -1; margin-bottom: 60px; background: linear-gradient(135deg, ${initiative.color}15, ${initiative.color}08); border-radius: 24px; overflow: hidden; box-shadow: 0 8px 32px rgba(0,0,0,0.08); border: 2px solid ${initiative.color}30;">
                            <!-- Initiative Header -->
                            <div style="display: flex; align-items: center; gap: 24px; padding: 32px 40px; background: ${initiative.color}; position: relative; overflow: hidden;">
                                <div style="position: absolute; top: -20px; right: -20px; width: 200px; height: 200px; background: rgba(255,255,255,0.1); border-radius: 50%; filter: blur(40px);"></div>
                                <div style="position: absolute; bottom: -30px; left: -30px; width: 180px; height: 180px; background: rgba(255,255,255,0.08); border-radius: 50%; filter: blur(40px);"></div>
                                
                                <div style="font-size: 72px; position: relative; z-index: 1; filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2));">${initiative.icon}</div>
                                <div style="flex: 1; position: relative; z-index: 1;">
                                    <h2 style="color: white; font-family: 'Cairo', sans-serif; font-size: 32px; margin: 0 0 8px 0; font-weight: 900; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">${initiative.name}</h2>
                                    <p style="color: rgba(255,255,255,0.95); font-size: 16px; margin: 0 0 12px 0; line-height: 1.6; text-shadow: 0 1px 2px rgba(0,0,0,0.1);">${initiative.description}</p>
                                    <div style="display: inline-flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.25); backdrop-filter: blur(10px); color: white; padding: 8px 18px; border-radius: 24px; font-size: 14px; font-weight: 700; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                        <span style="font-size: 16px;">ğŸ“‹</span>
                                        <span>${cases.length} ${cases.length === 1 ? 'Ø­Ø§Ù„Ø©' : 'Ø­Ø§Ù„Ø§Øª'}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Cases Grid inside Initiative -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 24px; padding: 36px;">
                    `;
                } else if (initId === 'unassigned') {
                    html += `
                        <div style="grid-column: 1 / -1; margin-bottom: 60px; background: linear-gradient(135deg, #f8f9fa, #ffffff); border-radius: 24px; overflow: hidden; box-shadow: 0 8px 32px rgba(0,0,0,0.06); border: 2px solid #e0e0e0;">
                            <div style="display: flex; align-items: center; gap: 24px; padding: 32px 40px; background: linear-gradient(135deg, #667eea, #764ba2);">
                                <div style="font-size: 64px; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.15));">ğŸ“‹</div>
                                <div style="flex: 1;">
                                    <h2 style="color: white; font-family: 'Cairo', sans-serif; font-size: 28px; margin: 0 0 8px 0; font-weight: 900; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">Ø­Ø§Ù„Ø§Øª Ø¹Ø§Ù…Ø©</h2>
                                    <p style="color: rgba(255,255,255,0.95); font-size: 15px; margin: 0; text-shadow: 0 1px 2px rgba(0,0,0,0.1);">Ø­Ø§Ù„Ø§Øª Ù„Ù… ÙŠØªÙ… ØªØµÙ†ÙŠÙÙ‡Ø§ Ø¶Ù…Ù† Ù…Ø¨Ø§Ø¯Ø±Ø© Ù…Ø­Ø¯Ø¯Ø©</p>
                                </div>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 24px; padding: 36px;">
                    `;
                }

                // Render cases for this initiative
                cases.forEach((caseItem) => {
                    const index = caseItem.originalIndex;
                    const percentage = Math.min((caseItem.collected / caseItem.target) * 100, 100);
                    const remaining = Math.max(caseItem.target - caseItem.collected, 0);
                    
                    const statusClasses = {
                        'active': 'active',
                        'urgent': 'urgent',
                        'completed': 'completed'
                    };

                    const statusTexts = {
                        'active': 'Ù†Ø´Ø·Ø©',
                        'urgent': 'Ø¹Ø§Ø¬Ù„Ø©',
                        'completed': 'Ù…ÙƒØªÙ…Ù„Ø©'
                    };

                    html += `
                        <div class="case-card" data-case-id="${index}" style="margin: 0;">
                            <div class="case-images">
                                ${caseItem.images.map((img, imgIndex) => `
                                    <img src="${img}" class="case-image ${imgIndex === 0 ? 'active' : ''}" 
                                         alt="${caseItem.title}" 
                                         ondblclick="openImageViewer(${index}, ${imgIndex})">
                                `).join('')}
                                ${caseItem.images.length > 1 ? `
                                    <button class="image-nav prev" onclick="navigateImages(${index}, -1)">â—€</button>
                                    <button class="image-nav next" onclick="navigateImages(${index}, 1)">â–¶</button>
                                    <div class="image-indicators">
                                        ${caseItem.images.map((_, i) => `
                                            <div class="indicator ${i === 0 ? 'active' : ''}" 
                                                 onclick="showImage(${index}, ${i})"></div>
                                        `).join('')}
                                    </div>
                                    <button class="slideshow-btn" onclick="toggleSlideshow(${index})">
                                        â–¶ Ø¹Ø±Ø¶ Ø´Ø±Ø§Ø¦Ø­
                                    </button>
                                ` : ''}
                            </div>
                            <div class="case-content">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                                    ${caseItem.status === 'urgent' ? `
                                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" style="flex-shrink: 0;">
                                            <circle cx="10" cy="10" r="8" fill="#EF4444"/>
                                            <path d="M10 6V11M10 14H10.01" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                        </svg>
                                    ` : caseItem.status === 'completed' ? `
                                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" style="flex-shrink: 0;">
                                            <circle cx="10" cy="10" r="8" fill="#10B981"/>
                                            <path d="M6 10L9 13L14 7" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    ` : `
                                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" style="flex-shrink: 0;">
                                            <circle cx="10" cy="10" r="8" fill="#3B82F6"/>
                                            <circle cx="10" cy="10" r="3" fill="white"/>
                                        </svg>
                                    `}
                                    <span class="case-status ${statusClasses[caseItem.status]}" style="background: transparent; padding: 0; font-size: 13px; font-weight: 600;">${statusTexts[caseItem.status]}</span>
                                </div>
                                <h3 class="case-title">${caseItem.title}</h3>
                                <p class="case-description">${caseItem.description}</p>
                                <div class="progress-section">
                                    <div class="progress-info">
                                        <span class="collected">ØªÙ… Ø¬Ù…Ø¹: ${formatCurrency(caseItem.collected)}</span>
                                        <span class="remaining">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${formatCurrency(remaining)}</span>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar" style="width: ${percentage}%; ${initiative ? `background: ${initiative.color};` : ''}">
                                            <span class="progress-percentage">${Math.round(percentage)}%</span>
                                        </div>
                                    </div>
                                    <div class="progress-info" style="margin-top: 8px;">
                                        <span style="color: var(--text-secondary); font-size: 13px;">Ø§Ù„Ù‡Ø¯Ù: ${formatCurrency(caseItem.target)}</span>
                                    </div>
                                </div>
                                <div class="case-actions">
                                    <button class="btn btn-primary" onclick="openDonationModal(${index})" ${initiative ? `style="background: ${initiative.color}; border-color: ${initiative.color};"` : ''}>
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                                        </svg>
                                        <span>ØªØ¨Ø±Ø¹ Ø§Ù„Ø¢Ù†</span>
                                    </button>
                                    <button class="btn btn-secondary" onclick="shareCase(${index})">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <circle cx="18" cy="5" r="3"/>
                                            <circle cx="6" cy="12" r="3"/>
                                            <circle cx="18" cy="19" r="3"/>
                                            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
                                            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
                                        </svg>
                                        <span>Ù…Ø´Ø§Ø±ÙƒØ©</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });

                // Close initiative container
                html += `
                            </div>
                        </div>
                `;
            });

            casesGrid.innerHTML = html;
        }

        // Image navigation
        let currentImageIndices = {};
        let slideshowIntervals = {};

        function navigateImages(caseId, direction) {
            const caseCard = document.querySelector(`[data-case-id="${caseId}"]`);
            const images = caseCard.querySelectorAll('.case-image');
            const indicators = caseCard.querySelectorAll('.indicator');
            
            if (!currentImageIndices[caseId]) currentImageIndices[caseId] = 0;
            
            images[currentImageIndices[caseId]].classList.remove('active');
            indicators[currentImageIndices[caseId]].classList.remove('active');
            
            currentImageIndices[caseId] = (currentImageIndices[caseId] + direction + images.length) % images.length;
            
            images[currentImageIndices[caseId]].classList.add('active');
            indicators[currentImageIndices[caseId]].classList.add('active');
        }

        function showImage(caseId, imageIndex) {
            const caseCard = document.querySelector(`[data-case-id="${caseId}"]`);
            const images = caseCard.querySelectorAll('.case-image');
            const indicators = caseCard.querySelectorAll('.indicator');
            
            images.forEach(img => img.classList.remove('active'));
            indicators.forEach(ind => ind.classList.remove('active'));
            
            images[imageIndex].classList.add('active');
            indicators[imageIndex].classList.add('active');
            currentImageIndices[caseId] = imageIndex;
        }

        function toggleSlideshow(caseId) {
            const btn = document.querySelector(`[data-case-id="${caseId}"] .slideshow-btn`);
            
            if (slideshowIntervals[caseId]) {
                clearInterval(slideshowIntervals[caseId]);
                slideshowIntervals[caseId] = null;
                btn.innerHTML = 'â–¶ Ø¹Ø±Ø¶ Ø´Ø±Ø§Ø¦Ø­';
                btn.classList.remove('playing');
            } else {
                slideshowIntervals[caseId] = setInterval(() => {
                    navigateImages(caseId, 1);
                }, 3000);
                btn.innerHTML = 'â¸ Ø¥ÙŠÙ‚Ø§Ù';
                btn.classList.add('playing');
            }
        }

        // Image Viewer
        let viewerData = { caseId: null, imageIndex: null };

        function openImageViewer(caseId, imageIndex) {
            viewerData = { caseId, imageIndex };
            const viewer = document.getElementById('imageViewer');
            const viewerImage = document.getElementById('viewerImage');
            viewerImage.src = appData.cases[caseId].images[imageIndex];
            viewer.classList.add('active');
        }

        function closeImageViewer() {
            document.getElementById('imageViewer').classList.remove('active');
        }

        function navigateViewerImage(direction) {
            const caseItem = appData.cases[viewerData.caseId];
            viewerData.imageIndex = (viewerData.imageIndex + direction + caseItem.images.length) % caseItem.images.length;
            document.getElementById('viewerImage').src = caseItem.images[viewerData.imageIndex];
        }

        function downloadViewerImage() {
            const link = document.createElement('a');
            link.href = document.getElementById('viewerImage').src;
            link.download = `Ù‚Ø·Ø±Ø§Øª_${Date.now()}.jpg`;
            link.click();
            showNotification('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­');
        }

        function shareViewerImage() {
            if (tg && tg.shareMessage) {
                const caseItem = appData.cases[viewerData.caseId];
                tg.shareMessage(`${caseItem.title}\n\nØ³Ø§Ø¹Ø¯ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠØ©\nØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${formatCurrency(caseItem.target)}`);
            } else {
                showNotification('Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù…ØªØ§Ø­Ø© ÙÙ‚Ø· ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ ØªÙ„ÙŠØ¬Ø±Ø§Ù…');
            }
        }

        // Share case
        function shareCase(caseId) {
            const caseItem = appData.cases[caseId];
            const percentage = Math.min((caseItem.collected / caseItem.target) * 100, 100);
            const remaining = caseItem.target - caseItem.collected;
            
            const message = `ğŸŒŸ ${caseItem.title}

${caseItem.description}

ğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${formatCurrency(caseItem.target)}
âœ… ØªÙ… Ø¬Ù…Ø¹: ${formatCurrency(caseItem.collected)} (${Math.round(percentage)}%)
â³ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${formatCurrency(remaining)}

Ø³Ø§Ø¹Ø¯Ù†Ø§ ÙÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙ‡Ù… ğŸ’š
Ù…Ø¤Ø³Ø³Ø© Ù‚Ø·Ø±Ø§Øª Ø§Ù„Ø®ÙŠØ±ÙŠØ©`;
            
            console.log('Attempting to share...');
            
            // Try Telegram Web App first
            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.shareMessage) {
                console.log('Using Telegram share');
                window.Telegram.WebApp.shareMessage(message);
                showNotification('ØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠ ØªÙ„ÙŠØ¬Ø±Ø§Ù… âœ…');
                return;
            }
            
            // Try Web Share API
            if (navigator.share) {
                console.log('Using Web Share API');
                navigator.share({
                    title: `${caseItem.title} - Ù‚Ø·Ø±Ø§Øª`,
                    text: message
                }).then(() => {
                    console.log('Share successful');
                    showNotification('ØªÙ…Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­ âœ…');
                }).catch((error) => {
                    // User cancelled or error occurred
                    if (error.name !== 'AbortError') {
                        console.log('Share failed, using clipboard');
                        copyToClipboard(message);
                    }
                });
                return;
            }
            
            // Fallback to clipboard
            console.log('Using clipboard fallback');
            copyToClipboard(message);
        }

        // Copy to clipboard fallback
        function copyToClipboard(text) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(() => {
                    showNotification('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†Øµ! Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ Ø£ÙŠ ØªØ·Ø¨ÙŠÙ‚ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©');
                }).catch(() => {
                    manualCopyToClipboard(text);
                });
            } else {
                manualCopyToClipboard(text);
            }
        }

        // Manual clipboard copy
        function manualCopyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.left = '-999999px';
            textarea.style.top = '0';
            document.body.appendChild(textarea);
            textarea.focus();
            textarea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showNotification('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†Øµ! Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ Ø£ÙŠ ØªØ·Ø¨ÙŠÙ‚ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©');
                } else {
                    showNotification('âš ï¸ Ø§Ø¶ØºØ· Ù…Ø·ÙˆÙ„Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†Øµ ÙˆØ§Ø®ØªØ± Ù†Ø³Ø®', true);
                }
            } catch (err) {
                console.error('Copy failed:', err);
                showNotification('âš ï¸ Ø§Ø¶ØºØ· Ù…Ø·ÙˆÙ„Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†Øµ ÙˆØ§Ø®ØªØ± Ù†Ø³Ø®', true);
            }
            
            document.body.removeChild(textarea);
        }

        // Donation Modal
        function openDonationModal(caseId) {
            const caseItem = appData.cases[caseId];
            const modal = document.getElementById('donationModal');
            const content = document.getElementById('donationContent');
            
            const bankAccountsHTML = appData.bankAccounts.length > 0 
                ? appData.bankAccounts.map(bank => `
                    <div class="bank-account" style="margin-bottom: 15px;">
                        <div class="bank-info">
                            <div class="bank-info-item">
                                <span class="bank-info-label">Ø§Ù„Ø¨Ù†Ùƒ:</span>
                                <span class="bank-info-value">${bank.name}</span>
                            </div>
                            <div class="bank-info-item">
                                <span class="bank-info-label">Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨:</span>
                                <span class="bank-info-value">${bank.account}</span>
                            </div>
                            <div class="bank-info-item">
                                <span class="bank-info-label">Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ø­Ø³Ø§Ø¨:</span>
                                <span class="bank-info-value">${bank.owner}</span>
                            </div>
                            ${bank.iban ? `
                                <div class="bank-info-item">
                                    <span class="bank-info-label">IBAN:</span>
                                    <span class="bank-info-value">${bank.iban}</span>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `).join('')
                : '<p style="text-align: center; color: var(--text-secondary);">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨Ø§Øª Ø¨Ù†ÙƒÙŠØ© Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</p>';

            content.innerHTML = `
                <div style="margin-bottom: 20px; padding: 15px; background: var(--accent-color); border-radius: 12px;">
                    <h3 style="color: var(--primary-color); margin-bottom: 10px;">${caseItem.title}</h3>
                    <p style="font-size: 14px; color: var(--text-secondary);">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: <strong style="color: var(--danger-color);">${formatCurrency(caseItem.target - caseItem.collected)}</strong></p>
                </div>

                <h4 style="margin-bottom: 15px; color: var(--text-primary);">Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©:</h4>
                ${bankAccountsHTML}

                <div style="margin-top: 25px; padding-top: 20px; border-top: 2px solid var(--accent-color);">
                    <h4 style="margin-bottom: 15px; color: var(--text-primary);">Ø¨Ø¹Ø¯ Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„:</h4>
                    <form id="confirmDonationForm" onsubmit="confirmDonation(event, ${caseId})">
                        <div class="form-group">
                            <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¨Ø±Ø¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                            <input type="text" class="form-input" id="donorName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
                            <small style="color: var(--text-secondary); font-size: 12px;">Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ø³Ù…Ùƒ Ù…Ø¹ Ø³Ø¬Ù„ Ø§Ù„ØªØ¨Ø±Ø¹Ø§Øª</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ø±Ø¹ Ø¨Ù‡ *</label>
                            <input type="number" class="form-input" id="donationAmount" required min="1" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ØµÙˆØ±Ø© Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                            <div class="file-upload" id="receiptUploadZone">
                                <input type="file" class="file-input" id="donationReceipt" accept="image/*">
                                <p>ğŸ“· Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„</p>
                            </div>
                            <div class="preview-images" id="receiptPreview"></div>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ¨Ø±Ø¹</button>
                    </form>
                </div>
            `;
            
            modal.classList.add('active');

            // Setup receipt upload
            const receiptZone = document.getElementById('receiptUploadZone');
            const receiptInput = document.getElementById('donationReceipt');
            
            receiptZone.onclick = () => receiptInput.click();
            
            receiptInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        document.getElementById('receiptPreview').innerHTML = `
                            <div class="preview-image">
                                <img src="${e.target.result}" alt="Receipt">
                            </div>
                        `;
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        function closeDonationModal() {
            document.getElementById('donationModal').classList.remove('active');
        }

        // Send receipt to Telegram
        async function sendReceiptToTelegram(receiptBase64, donorName, amount, caseName) {
            if (!appData.telegramBotToken || !appData.telegramChatId) {
                console.log('Telegram settings not configured');
                return;
            }

            try {
                // Prepare message
                const message = `ğŸ‰ ØªØ¨Ø±Ø¹ Ø¬Ø¯ÙŠØ¯!\n\n` +
                              `ğŸ‘¤ Ø§Ù„Ù…ØªØ¨Ø±Ø¹: ${donorName}\n` +
                              `ğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº: ${formatCurrency(amount)}\n` +
                              `ğŸ“‹ Ø§Ù„Ø­Ø§Ù„Ø©: ${caseName}\n` +
                              `ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleString('ar-EG')}\n\n` +
                              `ğŸ“¸ ØªÙ… Ø±ÙØ¹ Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„`;

                // Send message via Telegram Bot API
                const url = `https://api.telegram.org/bot${appData.telegramBotToken}/sendMessage`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: appData.telegramChatId,
                        text: message
                    })
                });

                const result = await response.json();
                
                if (result.ok) {
                    console.log('Notification sent to Telegram successfully');
                    
                    // Try to send photo using alternative method
                    await sendPhotoToTelegram(receiptBase64);
                    
                } else {
                    console.error('Telegram API error:', result);
                    if (result.description && result.description.includes('bot was blocked')) {
                        showNotification('ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ø§Ù„Ø¨ÙˆØª Ø£ÙˆÙ„Ø§Ù‹ ÙÙŠ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…', true);
                    } else if (result.description && result.description.includes('chat not found')) {
                        showNotification('Chat ID ØºÙŠØ± ØµØ­ÙŠØ­. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', true);
                    } else {
                        showNotification('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…: ' + result.description, true);
                    }
                }
            } catch (error) {
                console.error('Error sending to Telegram:', error);
                showNotification('ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø£Ùˆ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…', true);
            }
        }

        async function sendPhotoToTelegram(base64Image) {
            try {
                console.log('=== Starting photo upload to Telegram ===');
                
                // Convert base64 to blob with better compression
                const base64Data = base64Image.split(',')[1];
                
                // Decode base64
                const binaryString = atob(base64Data);
                const bytes = new Uint8Array(binaryString.length);
                for (let i = 0; i < binaryString.length; i++) {
                    bytes[i] = binaryString.charCodeAt(i);
                }
                
                // Create blob
                const blob = new Blob([bytes], { type: 'image/jpeg' });
                
                // Check blob size
                const sizeInKB = (blob.size / 1024).toFixed(2);
                const sizeInMB = (blob.size / (1024 * 1024)).toFixed(2);
                console.log('ğŸ“Š Photo size:', sizeInKB, 'KB (', sizeInMB, 'MB)');
                
                if (blob.size > 10485760) { // 10MB limit
                    console.log('âŒ Image too large for Telegram (max 10MB)');
                    showNotification('Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹. ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ÙÙ‚Ø· âœ…');
                    return;
                }
                
                // Create FormData
                const formData = new FormData();
                formData.append('chat_id', appData.telegramChatId);
                formData.append('photo', blob, 'receipt.jpg');
                formData.append('caption', 'ğŸ“¸ Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„');

                const url = `https://api.telegram.org/bot${appData.telegramBotToken}/sendPhoto`;
                
                console.log('ğŸ“¤ Sending photo to Telegram...');
                const response = await fetch(url, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                console.log('ğŸ“¥ Telegram response:', result);
                
                if (result.ok) {
                    console.log('âœ… Photo sent successfully!');
                    showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„Ø¥ÙŠØµØ§Ù„ Ù„Ù„Ø£Ø¯Ù…Ù† âœ…');
                } else {
                    console.error('âŒ Photo send failed:', result);
                    
                    if (result.description) {
                        console.log('Error description:', result.description);
                        
                        if (result.description.includes('too large') || result.description.includes('file size')) {
                            showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± (Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹) âœ…');
                        } else if (result.description.includes('wrong file identifier')) {
                            showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± (Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØµÙˆØ±Ø©) âœ…');
                        } else {
                            showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù†Ø¬Ø§Ø­ âœ…');
                        }
                    } else {
                        showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù†Ø¬Ø§Ø­ âœ…');
                    }
                }
            } catch (error) {
                console.error('âŒ Photo send error:', error);
                showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù†Ø¬Ø§Ø­ âœ…');
            }
        }

        function confirmDonation(event, caseId) {
            event.preventDefault();
            const amount = parseFloat(document.getElementById('donationAmount').value);
            const donorName = document.getElementById('donorName').value.trim();
            
            if (amount <= 0) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­', true);
                return;
            }

            // Get receipt image if uploaded
            const receiptPreview = document.getElementById('receiptPreview');
            const receiptImage = receiptPreview.querySelector('img');
            const receiptBase64 = receiptImage ? receiptImage.src : null;

            // Initialize donations array if not exists
            if (!appData.cases[caseId].donations) {
                appData.cases[caseId].donations = [];
            }

            // Add donation record
            const donation = {
                amount: amount,
                donorName: donorName || 'Ù…ØªØ¨Ø±Ø¹ ÙƒØ±ÙŠÙ…',
                date: new Date().toISOString(),
                timestamp: Date.now()
            };

            appData.cases[caseId].donations.push(donation);
            appData.cases[caseId].collected += amount;
            
            if (appData.cases[caseId].collected >= appData.cases[caseId].target) {
                appData.cases[caseId].status = 'completed';
            }

            saveData();
            renderCases();
            renderStats();
            
            // Send receipt to Telegram if uploaded
            if (receiptBase64) {
                const caseName = appData.cases[caseId].title;
                sendReceiptToTelegram(receiptBase64, donorName || 'Ù…ØªØ¨Ø±Ø¹ ÙƒØ±ÙŠÙ…', amount, caseName);
            }
            
            closeDonationModal();
            
            const thankYouMessage = donorName 
                ? `Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ ${donorName}! ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ù†Ø¬Ø§Ø­ ğŸ’š` 
                : 'Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ! ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ù†Ø¬Ø§Ø­ ğŸ’š';
            showNotification(thankYouMessage);
        }

        // Admin Panel - Secret Access
        let logoTapCount = 0;
        let logoTapTimer = null;

        // Check URL for admin access
        function checkAdminURL() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('admin') === 'true' || urlParams.get('Ù‚Ø·Ø±Ø§Øª') === 'Ø¥Ø¯Ø§Ø±Ø©') {
                showAdminLogin();
                // Clear URL parameter for security
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }

        // Secret admin access - tap logo 5 times quickly
        document.addEventListener('DOMContentLoaded', () => {
            checkAdminURL();
            
            const logo = document.querySelector('.logo');
            if (logo) {
                logo.style.cursor = 'pointer';
                logo.addEventListener('click', (e) => {
                    e.stopPropagation();
                    logoTapCount++;
                    
                    clearTimeout(logoTapTimer);
                    logoTapTimer = setTimeout(() => {
                        logoTapCount = 0;
                    }, 800);

                    if (logoTapCount === 5) {
                        showAdminLogin();
                        logoTapCount = 0;
                    }
                });
            }
        });

        function showAdminLogin() {
            const password = prompt('Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù†:');
            if (password === appData.adminPassword) {
                openAdminPanel();
            } else if (password !== null) {
                showNotification('ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©', true);
            }
        }

        function openAdminPanel() {
            document.getElementById('adminPanel').classList.add('active');
            renderInitiatives();
            renderBankAccounts();
            applyCurrency();
            updateStorageInfo();
            
            // Fill Telegram settings
            document.getElementById('telegramBotToken').value = appData.telegramBotToken || '';
            document.getElementById('telegramChatId').value = appData.telegramChatId || '';
        }

        function closeAdminPanel() {
            document.getElementById('adminPanel').classList.remove('active');
        }

        function switchAdminTab(tab) {
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + 'Tab').classList.add('active');
            
            // Hide any open forms when switching tabs
            if (tab === 'initiatives') {
                const formSection = document.getElementById('initiativeFormSection');
                const caseFormSection = document.getElementById('caseFormSection');
                const listSection = document.getElementById('initiativesListSection');
                if (formSection && listSection && caseFormSection) {
                    formSection.style.display = 'none';
                    caseFormSection.style.display = 'none';
                    listSection.style.display = 'block';
                }
            } else if (tab === 'bank') {
                const formSection = document.getElementById('bankFormSection');
                const listSection = document.getElementById('bankListSection');
                if (formSection && listSection) {
                    formSection.style.display = 'none';
                    listSection.style.display = 'block';
                }
            }
        }

        // Initiatives Management
        let editingInitiativeIndex = null;

        function renderInitiatives() {
            const list = document.getElementById('initiativesList');
            if (!list) return;
            
            if (appData.initiatives.length === 0) {
                list.innerHTML = '<div class="empty-state"><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø¯Ø±Ø§Øª Ø¨Ø¹Ø¯. Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ø§Ø¯Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©!</p></div>';
                return;
            }

            list.innerHTML = appData.initiatives.map((initiative, initIndex) => {
                const initiativeCases = appData.cases.filter(c => c.initiativeId === initIndex);
                
                return `
                    <div style="margin-bottom: 30px; padding: 20px; background: var(--accent-color); border-radius: var(--border-radius); border-right: 5px solid ${initiative.color};">
                        <!-- Initiative Header -->
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                                <span style="font-size: 42px;">${initiative.icon}</span>
                                <div style="flex: 1;">
                                    <h3 style="margin: 0 0 5px 0; color: ${initiative.color}; font-family: 'Cairo', sans-serif; font-size: 22px;">${initiative.name}</h3>
                                    <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">${initiative.description}</p>
                                    <p style="margin: 8px 0 0 0; font-size: 13px; color: var(--text-secondary);">
                                        ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„Ø§Øª: <strong style="color: ${initiative.color};">${initiativeCases.length}</strong>
                                    </p>
                                </div>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-edit btn-small" onclick="editInitiative(${initIndex})" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©">âœï¸</button>
                                <button class="btn btn-danger btn-small" onclick="deleteInitiative(${initIndex})" title="Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©">ğŸ—‘ï¸</button>
                            </div>
                        </div>

                        <!-- Add Case Button -->
                        <button class="btn btn-primary" onclick="showAddCaseForm(${initIndex})" style="width: 100%; margin-bottom: 15px;">
                            â• Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©
                        </button>

                        <!-- Cases List -->
                        <div style="display: grid; gap: 12px;">
                            ${initiativeCases.length > 0 ? initiativeCases.map(caseItem => {
                                const caseIndex = appData.cases.indexOf(caseItem);
                                const percentage = Math.min((caseItem.collected / caseItem.target) * 100, 100);
                                const statusIcons = {
                                    'active': 'ğŸŸ¢',
                                    'urgent': 'ğŸ”´',
                                    'completed': 'âœ…'
                                };
                                return `
                                    <div style="background: white; padding: 15px; border-radius: 12px; border-right: 3px solid ${initiative.color};">
                                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                                            <div style="flex: 1;">
                                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
                                                    <span>${statusIcons[caseItem.status]}</span>
                                                    <h4 style="margin: 0; font-size: 16px;">${caseItem.title}</h4>
                                                </div>
                                                <p style="margin: 0 0 8px 0; font-size: 13px; color: var(--text-secondary); line-height: 1.4;">
                                                    ${caseItem.description.substring(0, 80)}${caseItem.description.length > 80 ? '...' : ''}
                                                </p>
                                                <div style="font-size: 12px; color: var(--text-secondary);">
                                                    ğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº: ${formatCurrency(caseItem.collected)} / ${formatCurrency(caseItem.target)}
                                                    <span style="color: ${initiative.color}; font-weight: bold;">(${Math.round(percentage)}%)</span>
                                                </div>
                                                ${caseItem.donations && caseItem.donations.length > 0 ? `
                                                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 5px;">
                                                        ğŸ’š Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ†: <strong>${caseItem.donations.length}</strong>
                                                    </div>
                                                ` : ''}
                                            </div>
                                            <div style="display: flex; gap: 5px; margin-right: 10px;">
                                                <button class="btn btn-edit btn-small" onclick="editCase(${caseIndex})" title="ØªØ¹Ø¯ÙŠÙ„">âœï¸</button>
                                                <button class="btn btn-danger btn-small" onclick="deleteCase(${caseIndex})" title="Ø­Ø°Ù">ğŸ—‘ï¸</button>
                                            </div>
                                        </div>
                                        <div class="progress-bar-container" style="height: 6px;">
                                            <div class="progress-bar" style="width: ${percentage}%; background: ${initiative.color};"></div>
                                        </div>
                                    </div>
                                `;
                            }).join('') : `
                                <div style="text-align: center; padding: 30px; background: white; border-radius: 12px; color: var(--text-secondary);">
                                    <p style="margin: 0; font-size: 14px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø§Ù„Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø© Ø¨Ø¹Ø¯</p>
                                    <p style="margin: 5px 0 0 0; font-size: 12px;">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø£Ø¹Ù„Ø§Ù‡ Ù„Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</p>
                                </div>
                            `}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showAddInitiativeForm() {
            editingInitiativeIndex = null;
            document.getElementById('initiativeFormTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ø§Ø¯Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©';
            document.getElementById('initiativeForm').reset();
            
            const formSection = document.getElementById('initiativeFormSection');
            const listSection = document.getElementById('initiativesListSection');
            
            listSection.style.display = 'none';
            formSection.style.display = 'block';
            
            setTimeout(() => {
                formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        function cancelInitiativeForm() {
            const formSection = document.getElementById('initiativeFormSection');
            const listSection = document.getElementById('initiativesListSection');
            
            formSection.style.display = 'none';
            listSection.style.display = 'block';
            
            document.getElementById('initiativeForm').reset();
            editingInitiativeIndex = null;
        }

        function editInitiative(index) {
            editingInitiativeIndex = index;
            const initiative = appData.initiatives[index];
            
            document.getElementById('initiativeFormTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©';
            document.getElementById('initiativeName').value = initiative.name;
            document.getElementById('initiativeDescription').value = initiative.description;
            document.getElementById('initiativeIcon').value = initiative.icon;
            document.getElementById('initiativeColor').value = initiative.color;
            
            const formSection = document.getElementById('initiativeFormSection');
            const listSection = document.getElementById('initiativesListSection');
            
            listSection.style.display = 'none';
            formSection.style.display = 'block';
            
            setTimeout(() => {
                formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        function deleteInitiative(index) {
            const casesCount = appData.cases.filter(c => c.initiativeId === index).length;
            
            if (casesCount > 0) {
                if (!confirm(`âš ï¸ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ${casesCount} Ø­Ø§Ù„Ø©. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°ÙÙ‡Ø§ Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ§Ø¨Ø¹Ø© Ù„Ù‡Ø§ØŸ`)) {
                    return;
                }
                // Remove all cases belonging to this initiative
                appData.cases = appData.cases.filter(c => c.initiativeId !== index);
                // Update initiativeId for remaining cases
                appData.cases.forEach(c => {
                    if (c.initiativeId > index) {
                        c.initiativeId--;
                    }
                });
            } else {
                if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©ØŸ')) {
                    return;
                }
            }
            
            appData.initiatives.splice(index, 1);
            saveData();
            renderInitiatives();
            renderCases();
            renderStats();
            showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø© Ø¨Ù†Ø¬Ø§Ø­');
        }

        function submitInitiativeForm(e) {
            if (e) e.preventDefault();
            
            try {
                const initiativeData = {
                    name: document.getElementById('initiativeName').value,
                    description: document.getElementById('initiativeDescription').value,
                    icon: document.getElementById('initiativeIcon').value,
                    color: document.getElementById('initiativeColor').value
                };

                if (editingInitiativeIndex !== null) {
                    appData.initiatives[editingInitiativeIndex] = initiativeData;
                    showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø© Ø¨Ù†Ø¬Ø§Ø­');
                } else {
                    appData.initiatives.push(initiativeData);
                    showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø© Ø¨Ù†Ø¬Ø§Ø­');
                }

                saveData();
                cancelInitiativeForm();
                renderInitiatives();
                
                return false;
            } catch (error) {
                console.error('Error in submitInitiativeForm:', error);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸: ' + error.message, true);
                return false;
            }
        }

        function updateCaseInitiativeOptions() {
            const select = document.getElementById('caseInitiative');
            if (!select) return;
            
            const currentValue = select.value;
            select.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø© --</option>' + 
                appData.initiatives.map((init, index) => 
                    `<option value="${index}">${init.icon} ${init.name}</option>`
                ).join('');
            
            if (currentValue !== '') {
                select.value = currentValue;
            }
        }

        function switchAdminTab(tab) {
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + 'Tab').classList.add('active');
            
            // Hide any open forms when switching tabs
            if (tab === 'cases') {
                const formSection = document.getElementById('caseFormSection');
                const listSection = document.getElementById('casesListSection');
                if (formSection && listSection) {
                    formSection.style.display = 'none';
                    listSection.style.display = 'block';
                }
            } else if (tab === 'bank') {
                const formSection = document.getElementById('bankFormSection');
                const listSection = document.getElementById('bankListSection');
                if (formSection && listSection) {
                    formSection.style.display = 'none';
                    listSection.style.display = 'block';
                }
            }
        }

        // Render admin cases list
        function renderAdminCases() {
            const list = document.getElementById('adminCasesList');
            if (appData.cases.length === 0) {
                list.innerHTML = '<div class="empty-state"><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø§Ù„Ø§Øª</p></div>';
                return;
            }

            list.innerHTML = appData.cases.map((caseItem, index) => `
                <div class="case-item">
                    <div class="case-item-info">
                        <h4 style="margin-bottom: 5px;">${caseItem.title}</h4>
                        <p style="font-size: 13px; color: var(--text-secondary);">Ø§Ù„Ù‡Ø¯Ù: ${formatCurrency(caseItem.target)} | Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${formatCurrency(caseItem.collected)}</p>
                    </div>
                    <div class="case-item-actions">
                        <button class="btn btn-edit btn-small" onclick="editCase(${index})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn btn-danger btn-small" onclick="deleteCase(${index})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </div>
                </div>
            `).join('');
        }

        // Case management
        let editingCaseIndex = null;
        let tempCaseImages = [];

        function showAddCaseForm(initiativeId) {
            editingCaseIndex = null;
            tempCaseImages = [];
            document.getElementById('caseFormTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©';
            document.getElementById('caseForm').reset();
            document.getElementById('previewImages').innerHTML = '';
            document.getElementById('caseInitiativeId').value = initiativeId;
            
            const formSection = document.getElementById('caseFormSection');
            const listSection = document.getElementById('initiativesListSection');
            const initiativeFormSection = document.getElementById('initiativeFormSection');
            
            listSection.style.display = 'none';
            initiativeFormSection.style.display = 'none';
            formSection.style.display = 'block';
            
            // Show which initiative this case belongs to
            const initiative = appData.initiatives[initiativeId];
            if (initiative) {
                document.getElementById('caseFormTitle').innerHTML = `
                    Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    <div style="font-size: 14px; font-weight: normal; color: var(--text-secondary); margin-top: 5px;">
                        ${initiative.icon} Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©: ${initiative.name}
                    </div>
                `;
            }
            
            // Scroll to form with animation
            setTimeout(() => {
                formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
            
            setupFileUpload();
        }

        function cancelCaseForm() {
            const formSection = document.getElementById('caseFormSection');
            const listSection = document.getElementById('initiativesListSection');
            
            formSection.style.display = 'none';
            listSection.style.display = 'block';
            
            document.getElementById('caseForm').reset();
            tempCaseImages = [];
            editingCaseIndex = null;
            document.getElementById('previewImages').innerHTML = '';
        }

        function editCase(index) {
            editingCaseIndex = index;
            const caseItem = appData.cases[index];
            tempCaseImages = [...caseItem.images];
            
            document.getElementById('caseInitiativeId').value = caseItem.initiativeId;
            document.getElementById('caseTitle').value = caseItem.title;
            document.getElementById('caseDescription').value = caseItem.description;
            document.getElementById('caseTarget').value = caseItem.target;
            document.getElementById('caseCollected').value = caseItem.collected;
            document.getElementById('caseStatus').value = caseItem.status;
            
            // Show which initiative this case belongs to
            const initiative = appData.initiatives[caseItem.initiativeId];
            if (initiative) {
                document.getElementById('caseFormTitle').innerHTML = `
                    ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø©
                    <div style="font-size: 14px; font-weight: normal; color: var(--text-secondary); margin-top: 5px;">
                        ${initiative.icon} Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©: ${initiative.name}
                    </div>
                `;
            } else {
                document.getElementById('caseFormTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø©';
            }
            
            renderPreviewImages();
            
            const formSection = document.getElementById('caseFormSection');
            const listSection = document.getElementById('initiativesListSection');
            const initiativeFormSection = document.getElementById('initiativeFormSection');
            
            listSection.style.display = 'none';
            initiativeFormSection.style.display = 'none';
            formSection.style.display = 'block';
            
            // Scroll to form with animation
            setTimeout(() => {
                formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
            
            setupFileUpload();
        }

        function deleteCase(index) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø©ØŸ')) {
                appData.cases.splice(index, 1);
                saveData();
                renderInitiatives();
                renderCases();
                renderStats();
                showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­');
            }
        }

        function setupFileUpload() {
            try {
                const zone = document.getElementById('fileUploadZone');
                const input = document.getElementById('caseImages');

                if (!zone || !input) {
                    console.error('File upload elements not found');
                    return;
                }

                console.log('Setting up file upload');

                // Remove old event listeners by cloning
                const newZone = zone.cloneNode(true);
                zone.parentNode.replaceChild(newZone, zone);
                
                const finalZone = document.getElementById('fileUploadZone');
                const finalInput = document.getElementById('caseImages');

                finalZone.onclick = () => {
                    console.log('Upload zone clicked');
                    finalInput.click();
                };

                finalZone.ondragover = (e) => {
                    e.preventDefault();
                    finalZone.classList.add('drag-over');
                };

                finalZone.ondragleave = () => {
                    finalZone.classList.remove('drag-over');
                };

                finalZone.ondrop = (e) => {
                    e.preventDefault();
                    finalZone.classList.remove('drag-over');
                    handleFiles(e.dataTransfer.files);
                };

                finalInput.onchange = (e) => {
                    console.log('File input changed');
                    handleFiles(e.target.files);
                };
            } catch (error) {
                console.error('Error setting up file upload:', error);
            }
        }

        function handleFiles(files) {
            console.log('Files selected:', files.length);
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    compressImage(file, (compressedBase64) => {
                        tempCaseImages.push(compressedBase64);
                        console.log('Image added, total:', tempCaseImages.length);
                        renderPreviewImages();
                    });
                }
            });
        }

        // Compress image before storing
        function compressImage(file, callback) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    let width = img.width;
                    let height = img.height;
                    
                    // Resize to smaller size (max 600px for Telegram)
                    const maxSize = 600; // Reduced from 800
                    if (width > height) {
                        if (width > maxSize) {
                            height *= maxSize / width;
                            width = maxSize;
                        }
                    } else {
                        if (height > maxSize) {
                            width *= maxSize / height;
                            height = maxSize;
                        }
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    
                    const ctx = canvas.getContext('2d');
                    // Add white background
                    ctx.fillStyle = 'white';
                    ctx.fillRect(0, 0, width, height);
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // Compress to JPEG with lower quality for Telegram
                    const compressedBase64 = canvas.toDataURL('image/jpeg', 0.5); // Reduced from 0.7
                    
                    const originalKB = (e.target.result.length * 0.75 / 1024).toFixed(2);
                    const compressedKB = (compressedBase64.length * 0.75 / 1024).toFixed(2);
                    console.log(`Image compressed: ${originalKB}KB â†’ ${compressedKB}KB (${((1 - compressedKB/originalKB) * 100).toFixed(1)}% smaller)`);
                    
                    callback(compressedBase64);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function renderPreviewImages() {
            try {
                const preview = document.getElementById('previewImages');
                if (!preview) {
                    console.error('Preview container not found');
                    return;
                }
                
                console.log('Rendering preview images, count:', tempCaseImages.length);
                preview.innerHTML = tempCaseImages.map((img, index) => `
                    <div class="preview-image">
                        <img src="${img}" alt="Preview ${index + 1}">
                        <button type="button" class="preview-remove" onclick="removePreviewImage(${index})">Ã—</button>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error rendering preview images:', error);
            }
        }

        function removePreviewImage(index) {
            tempCaseImages.splice(index, 1);
            renderPreviewImages();
        }

        function submitCaseForm(e) {
            if (e) e.preventDefault();
            console.log('Form submitted, images count:', tempCaseImages.length);

            if (tempCaseImages.length === 0) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', true);
                return false;
            }

            try {
                const title = document.getElementById('caseTitle').value;
                const description = document.getElementById('caseDescription').value;
                const target = parseFloat(document.getElementById('caseTarget').value);
                const collected = parseFloat(document.getElementById('caseCollected').value) || 0;
                const status = document.getElementById('caseStatus').value;

                console.log('Form values:', { title, description, target, collected, status });

                if (!title || !description || !target || target <= 0) {
                    showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', true);
                    return false;
                }

                const initiativeId = parseInt(document.getElementById('caseInitiativeId').value);
                
                if (isNaN(initiativeId) || initiativeId < 0) {
                    showNotification('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©', true);
                    return false;
                }

                const caseData = {
                    initiativeId: initiativeId,
                    title: title,
                    description: description,
                    target: target,
                    collected: collected,
                    status: status,
                    images: [...tempCaseImages]
                };

                console.log('Case data prepared:', caseData);

                if (editingCaseIndex !== null) {
                    appData.cases[editingCaseIndex] = caseData;
                    console.log('Updating case at index:', editingCaseIndex);
                } else {
                    appData.cases.push(caseData);
                    console.log('Adding new case, total cases:', appData.cases.length);
                }

                const saved = saveData();
                if (!saved) {
                    console.error('Failed to save data');
                    return false;
                }

                console.log('Data saved successfully');
                
                if (editingCaseIndex !== null) {
                    showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­');
                } else {
                    showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­');
                }

                cancelCaseForm();
                renderInitiatives();
                renderCases();
                renderStats();
                
                return false;
            } catch (error) {
                console.error('Error in submitCaseForm:', error);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸: ' + error.message, true);
                return false;
            }
        }

        // Bank accounts management
        function renderBankAccounts() {
            const list = document.getElementById('bankAccountsList');
            if (appData.bankAccounts.length === 0) {
                list.innerHTML = '<div class="empty-state"><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨Ø§Øª Ø¨Ù†ÙƒÙŠØ©</p></div>';
                return;
            }

            list.innerHTML = appData.bankAccounts.map((bank, index) => `
                <div class="bank-account">
                    <div class="bank-info">
                        <div class="bank-info-item">
                            <span class="bank-info-label">Ø§Ù„Ø¨Ù†Ùƒ:</span>
                            <span class="bank-info-value">${bank.name}</span>
                        </div>
                        <div class="bank-info-item">
                            <span class="bank-info-label">Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨:</span>
                            <span class="bank-info-value">${bank.account}</span>
                        </div>
                        <div class="bank-info-item">
                            <span class="bank-info-label">Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ø­Ø³Ø§Ø¨:</span>
                            <span class="bank-info-value">${bank.owner}</span>
                        </div>
                        ${bank.iban ? `
                            <div class="bank-info-item">
                                <span class="bank-info-label">IBAN:</span>
                                <span class="bank-info-value">${bank.iban}</span>
                            </div>
                        ` : ''}
                    </div>
                    <button class="btn btn-danger btn-small" style="margin-top: 10px;" onclick="deleteBankAccount(${index})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                </div>
            `).join('');
        }

        function showAddBankForm() {
            document.getElementById('bankForm').reset();
            
            const formSection = document.getElementById('bankFormSection');
            const listSection = document.getElementById('bankListSection');
            
            listSection.style.display = 'none';
            formSection.style.display = 'block';
            
            // Scroll to form with animation
            setTimeout(() => {
                formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        function cancelBankForm() {
            const formSection = document.getElementById('bankFormSection');
            const listSection = document.getElementById('bankListSection');
            
            formSection.style.display = 'none';
            listSection.style.display = 'block';
            
            document.getElementById('bankForm').reset();
        }

        function deleteBankAccount(index) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ØŸ')) {
                appData.bankAccounts.splice(index, 1);
                saveData();
                renderBankAccounts();
                showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
            }
        }

        function submitBankForm(e) {
            e.preventDefault();

            const bankData = {
                name: document.getElementById('bankName').value,
                account: document.getElementById('bankAccount').value,
                owner: document.getElementById('bankOwner').value,
                iban: document.getElementById('bankIban').value
            };

            appData.bankAccounts.push(bankData);
            saveData();
            renderBankAccounts();
            cancelBankForm();
            showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
        }

        // Test Telegram connection
        async function testTelegramConnection() {
            const botToken = document.getElementById('telegramBotToken').value.trim();
            const chatId = document.getElementById('telegramChatId').value.trim();
            
            if (!botToken || !chatId) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Bot Token Ùˆ Chat ID Ø£ÙˆÙ„Ø§Ù‹', true);
                return;
            }
            
            showNotification('Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...', false);
            
            try {
                const url = `https://api.telegram.org/bot${botToken}/sendMessage`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: chatId,
                        text: 'âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ù†Ø§Ø¬Ø­!\n\nØ§Ù„Ø¨ÙˆØª ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­. Ø³ØªØªÙ„Ù‚Ù‰ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØªØ¨Ø±Ø¹Ø§Øª Ù‡Ù†Ø§.'
                    })
                });

                const result = await response.json();
                
                if (result.ok) {
                    showNotification('âœ… Ù†Ø¬Ø­ Ø§Ù„Ø§ØªØµØ§Ù„! ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…', false);
                } else {
                    console.error('Test failed:', result);
                    
                    let errorMsg = 'ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„: ';
                    if (result.description) {
                        if (result.description.includes('bot was blocked')) {
                            errorMsg = 'âŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ ÙØªØ­ Ø§Ù„Ø¨ÙˆØª ÙÙŠ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… ÙˆØ§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Start"';
                        } else if (result.description.includes('chat not found')) {
                            errorMsg = 'âŒ Chat ID ØºÙŠØ± ØµØ­ÙŠØ­. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù…';
                        } else if (result.description.includes('Unauthorized')) {
                            errorMsg = 'âŒ Bot Token ØºÙŠØ± ØµØ­ÙŠØ­';
                        } else {
                            errorMsg += result.description;
                        }
                    }
                    
                    showNotification(errorMsg, true);
                }
            } catch (error) {
                console.error('Test error:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª', true);
            }
        }

        // Update admin password and settings
        function updateSettings() {
            const newPassword = document.getElementById('adminPassword').value;
            const newCurrency = document.getElementById('currencySelector').value;
            const botToken = document.getElementById('telegramBotToken').value;
            const chatId = document.getElementById('telegramChatId').value;
            
            let updated = false;
            
            if (newPassword && newPassword.length >= 4) {
                appData.adminPassword = newPassword;
                document.getElementById('adminPassword').value = '';
                updated = true;
            }
            
            if (newCurrency && newCurrency !== appData.currency) {
                appData.currency = newCurrency;
                updated = true;
                renderCases();
                renderStats();
            }
            
            // Save Telegram settings
            if (botToken !== appData.telegramBotToken) {
                appData.telegramBotToken = botToken.trim();
                updated = true;
            }
            
            if (chatId !== appData.telegramChatId) {
                appData.telegramChatId = chatId.trim();
                updated = true;
            }
            
            if (updated) {
                saveData();
                showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
            } else if (newPassword && newPassword.length < 4) {
                showNotification('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', true);
            }
        }

        // Clear all data
        function clearAllData() {
            if (confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ\n\nØ³ÙŠØªÙ… Ø­Ø°Ù:\nâ€¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª\nâ€¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª\nâ€¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©\nâ€¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª\n\nÙ‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡!')) {
                if (confirm('ØªØ£ÙƒÙŠØ¯ Ù†Ù‡Ø§Ø¦ÙŠ: Ù‡Ù„ ØªØ±ÙŠØ¯ ÙØ¹Ù„Ø§Ù‹ Ø­Ø°Ù ÙƒÙ„ Ø´ÙŠØ¡ØŸ')) {
                    localStorage.removeItem('qataratData');
                    appData = {
                        initiatives: [],
                        cases: [],
                        bankAccounts: [],
                        adminPassword: 'admin123',
                        currency: 'SDG',
                        theme: 'light',
                        telegramBotToken: '',
                        telegramChatId: ''
                    };
                    renderInitiatives();
                    renderCases();
                    renderStats();
                    renderAdminCases();
                    renderBankAccounts();
                    showNotification('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                    closeAdminPanel();
                }
            }
        }

        // Update storage info
        function updateStorageInfo() {
            const infoElement = document.getElementById('storageInfo');
            if (!infoElement) return;
            
            try {
                const dataStr = JSON.stringify(appData);
                const sizeInBytes = new Blob([dataStr]).size;
                const sizeInKB = (sizeInBytes / 1024).toFixed(2);
                const sizeInMB = (sizeInBytes / 1024 / 1024).toFixed(2);
                
                // LocalStorage limit is usually 5-10 MB
                const limitMB = 5;
                const usagePercent = ((sizeInBytes / (limitMB * 1024 * 1024)) * 100).toFixed(1);
                
                let sizeText = sizeInKB < 1024 ? `${sizeInKB} ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª` : `${sizeInMB} Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª`;
                let statusColor = usagePercent < 50 ? 'var(--success-color)' : 
                                 usagePercent < 80 ? 'var(--warning-color)' : 
                                 'var(--danger-color)';
                
                infoElement.innerHTML = `
                    <div style="margin-bottom: 8px;">
                        <strong>Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</strong> ${sizeText}
                    </div>
                    <div style="margin-bottom: 8px;">
                        <strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„Ø§Øª:</strong> ${appData.cases.length}
                    </div>
                    <div style="margin-bottom: 8px;">
                        <strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©:</strong> ${appData.bankAccounts.length}
                    </div>
                    <div style="margin-bottom: 10px;">
                        <strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</strong> <span style="color: ${statusColor}; font-weight: bold;">${usagePercent}%</span>
                    </div>
                    <div class="progress-bar-container" style="margin-top: 10px;">
                        <div class="progress-bar" style="width: ${Math.min(usagePercent, 100)}%; background: ${statusColor};"></div>
                    </div>
                `;
            } catch (error) {
                console.error('Error calculating storage:', error);
                infoElement.textContent = 'Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©';
            }
        }

        // Notification
        function showNotification(message, isError = false) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification' + (isError ? ' error' : '');
            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Initialize app
        loadData();
        renderCases();
        renderStats();
        
        // Setup theme toggle
        document.getElementById('themeToggle').addEventListener('click', toggleTheme);

        // Demo data for first time
        if (appData.cases.length === 0) {
            appData.cases = [
                {
                    title: 'Ø¹Ø§Ø¦Ù„Ø© Ù…Ø­ØªØ§Ø¬Ø© - 5 Ø£Ø·ÙØ§Ù„',
                    description: 'Ø¹Ø§Ø¦Ù„Ø© Ù…ÙƒÙˆÙ†Ø© Ù…Ù† 5 Ø£Ø·ÙØ§Ù„ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¹Ø§Ø¬Ù„Ø© Ù„ØªÙˆÙÙŠØ± Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙ‡Ø§ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù…Ù† Ø·Ø¹Ø§Ù… ÙˆÙ…Ù„Ø¨Ø³',
                    target: 50000,
                    collected: 15000,
                    status: 'urgent',
                    images: ['data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iIzJCN0E3OCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+2LnYp9im2YTYqSDZhdit2KrYp9is2Kk8L3RleHQ+PC9zdmc+']
                }
            ];
            saveData();
            renderCases();
            renderStats();
        }
    </script>
</body>
</html>
